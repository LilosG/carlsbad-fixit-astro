---
import SeoHead from "../../components/SeoHead.astro"
import JsonLd from "../../components/JsonLd.astro"
const canonical = new URL(Astro.url.pathname, Astro.site ?? 'https://sandiegohandymanpro.co').toString()
let __TITLE = `{__CITYNAME} Handyman Services`
let __DESC = `Local handyman services in {__CITYNAME}, San Diego County.`
const __CITY = typeof Astro.params?.city === "string" ? Astro.params.city : ""; const __CITYNAME = __CITY.split("-").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" "); const __JSONLD = [{ "@context":"https://schema.org", "@type":"Place", "name": __CITYNAME, "geo": {}, "url": canonical }, { "@context":"https://schema.org", "@type":"WebPage", "name": __TITLE, "url": canonical }]
import Base from "../../layouts/Base.astro"
import { cities } from "../../data/cities"
import { services } from "../../data/services"

export async function getStaticPaths() {
  return cities.map(c => ({ params: { city: c.slug }, props: { city: c } }))
}

const { city } = Astro.props
const page = {
  title: `${city.name} Handyman Services | San Diego HandyMan Pros`,
  description: `Affordable, reliable handyman services in ${city.name}. Free estimates.`,
  canonical: Astro.url ? Astro.url.href : undefined
}

const crumbs = [
  { name: "Home", url: "/" },
  { name: "Service Areas", url: "/service-areas" },
  { name: city.name, url: Astro.url ? Astro.url.pathname : `/service-area/${city.slug}` }
]

const breadcrumbLd = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": crumbs.map((c, i) => ({
    "@type": "ListItem",
    position: i + 1,
    name: c.name,
    item: new URL(c.url, Astro.site || "https://sandiegohandymanpro.co").href
  }))
}

const cityLd = {
  "@context": "https://schema.org",
  "@type": "LocalBusiness",
  "name": "San Diego HandyMan Pros",
  "areaServed": city.name,
  "telephone": "619-123-4567",
  "address": {
    "@type":"PostalAddress",
    "streetAddress":"401 W A St Ste 200",
    "addressLocality":"San Diego",
    "addressRegion":"CA",
    "postalCode":"92101"
  }
}
---
<SeoHead title={__TITLE} description={__DESC} canonical={canonical} />
<JsonLd data={__JSONLD} />
<Base {page}>
  <section class="mx-auto max-w-7xl px-4 py-12">
    <nav class="text-sm text-gray-600"><a href="/">Home</a> / <a href="/service-areas">Service Areas</a> / <span class="font-medium">{city.name}</span></nav>
    <h1 class="mt-4 text-3xl font-semibold">{city.name} handyman services</h1>
    <p class="mt-4 max-w-2xl text-gray-700">Local, insured professionals serving {city.name}. Choose a service to get started.</p>
    <ul class="mt-8 grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
      {services.length === 0 ? (
        <li class="text-gray-600">Services list coming soon.</li>
      ) : (
        services.map(s => (
          <li class="border rounded-2xl p-5 hover:shadow-sm">
            <a class="underline" href={`/${city.slug}/${s.slug}`}>{s.name} in {city.name}</a>
          </li>
        ))
      )}
    </ul>
  </section>
  <JsonLd data={breadcrumbLd} />
  <JsonLd data={cityLd} />
</Base>
